Dockerfile
---
---

`Dockerfile` - специальный файл который описывает какое изображение,
требуется создать.

Для создания образа нашего проекта, располагаем `Dockerfile` в файле
в корне нашего приложения, и описываем в нем команды для создания
образа, на основе той программы в которой находится этот докер файл.

---
Команды докер файла
---
**FROM** - указываем родительский образ, он будет являться базовым,
для всего что будет на нем располагаться.

Создание образа OC Linux с установленным а python3.8 

```dockerfile
# Полноценная версия python
FROM python:3.8-buster

# Сильно урезанная версия python
FROM python:3.8-alpine
```

Существует множество образов, они подтягиваются с Docker hub, если
мы будем устанавливать пакеты, то в зависимости от содержимого 
базового образа, можем получить ошибки, ибо образ `python:3.8-alpine`
может просто не содержать нужных библиотек, так что надо следить
за тем образом который устанавливаем.

---
**COPY** - копирует что-то из корня нашего приложения в котором 
находится Dockerfile ппо указанному пути внутрь нашего контейнера. 

К примеру, скопировать все что есть, это указание символа точки ` . `
копировать в директорию по пути `/usr/src/app` внутрь нашего
контейнера, таким образом все файлы нашего проекта, будут скопированы
в указанную директорию.

```dockerfile
COPY . /usr/src/app
```

---
**WORKDIR** - изменить рабочую директорию, указываем путь к 
директории, после чего для всех последующих команд данная директория
становится рабочей, и команды будут исполняться там.

```dockerfile
WORKDIR /usr/src/app
```

---
**RUN** - запускает некоторую команду, в терминале внутри созданного
изображения, эта команда выполняется сразу же, то что будет выполнено
этой командой станет часть образа.

К примеру, установка зависимостей, все пакеты будут установлены,
и далее эти сам образ будет уже с этими установленными пакетами.

```dockerfile
RUN pip install -r requirements/production.txt
```

---
**CMD** - установка некоторой команды, эта команда не будет 
выполнена сразу же, и все ее производные не будут частью образа, 
но когда на основе этого образа мы создадим контейнер, то по 
умолчанию именно эта команда будет сразу же выполнена внутри
созданного контейнера.

Применение миграций будет на этапе создания контейнера. 

```dockerfile
CMD python3 manage.py migrate
```

или

```dockerfile
CMD ["python3", "manage.py", "migrate"]
```

---
**EXPOSE** - указывает порт который, требуется открыть в основную систему,
просто прокидываем порт, благодаря чему программа слушающая свой порт в
своем контейнере будет доступна в основной системе через прокинутый порт.

```dockerfile
EXPOSE 5000
```

---
**ENV**

```dockerfile
ENV PYTHONUNBUFFERED 1
```

---
**ADD**

```dockerfile
ADD . /code/
```

---
**ENTRYPOINT**

---
**MAINTAINER**

---
**USER**

---
**VOLUME**
